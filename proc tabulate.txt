/* The TABULATE procedure displays descriptive statistics in tabular format, */
/* using some or all of the variables in a data set. */
/* You can create a variety of tables rangingfrom simple to highly customized. */
/* PROC TABULATE computes many of the same statistics */
/* that are computed by other descriptive statistical procedures */
/* such as MEANS, FREQ, and REPORT. PROC TABULATE provides the following features: */

data energy;
   length State $2;
   input Region Division state $ Type Expenditures;
   datalines;
1 1 ME 1 708
1 1 ME 2 379
4 4 HI 1 273
4 4 HI 2 298
;
data classes;
   input region division type;
   datalines;
1 1 1
1 1 2
4 4 1
4 4 2
;

data carsurvey;
   input Rater Age Progressa Remark Jupiter Dynamo;
   datalines;
1   38  94  98  84  80
2   49  96  84  80  77
3   16  64  78  76  73
4   27  89  73  90  92
77   61  92  88  77  85
78   24  87  88  88  91
79   18  54  50  62  74
80   62  90  91  90  86
;

data customer_response;
   input Customer Factor1-Factor4 Source1-Source3
         Quality1-Quality3;
   datalines;
1 . . 1 1 1 1 . 1 . .
2 1 1 . 1 1 1 . 1 1 .
3 . . 1 1 1 1 . . . .
119 . . . 1 . . . 1 . .
120 1 1 . 1 . . . . 1 .
;

proc format;
   value regfmt 1='Northeast'
                2='South'
                3='Midwest'
                4='West';
   value divfmt 1='New England'
                2='Middle Atlantic'
                3='Mountain'
                4='Pacific';
   value usetype 1='Residential Customers'
                 2='Business Customers';
run;

proc format;
value agefmt (multilabel notsorted)
15 - 29 ="Below 30 years"
30 - 50 ="Between 30 and 50"
51 - high ="Over 50 years"
15 - 19 ="15 to 19"
20 - 24 ="20 to 25"
25 - 39 ="25 to 39"
40 - 55 ="40 to 55"
56 - high ="56 and above"
;run;

proc tabulate data=energy format=dollar12. classdata=classes exclusive;
class region division type;
var expenditures;
table region*division,
	type*expenditures
	/ rts=25;
format region regfmt. division divfmt. type usetype.;
title "Energy Expenditures for Each Region";
title2 "(millions of dollars)";
run;

proc tabulate data=energy format=dollar12. out=tabdata;
   class region division type / preloadfmt exclusive;
   var expenditures;
   table region*division,
         type*expenditures / rts=25;
   format region regfmt. division divfmt. type usetype.;
   title 'Energy Expenditures for Each Region';
   title2 '(millions of dollars)';
run;

proc print data=tabdata;
run;

proc tabulate data=carsurvey format=10.;
class age / mlf;
var progressa remark jupiter dynamo;
table age, n all="Potential Car Names"*(progressa remark jupiter dynamo)*mean;
title1 "Rating Four Potential Car Names";
title2 "Rating Scale 0-100 (100 is the highest rating)";
format age agefmt.;
run;

proc tabulate data=energy format=comma12.;
class region division type;
var expenditures;
table region*(division all='Subtotal')
all='Total for All Regions'*f=dollar12.,
type='Customer Base'*expenditures=' '*sum=' '
all='All Customers'*expenditures=' '*sum=' '
/ rts=25;
format region regfmt. division divfmt. type usetype.;
title 'Energy Expenditures for Each Region';
title2 '(millions of dollars)';
run;

proc tabulate data=energy format=dollar12.;
class region division type;
var expenditures;
table region="Region: " all="All Regions",
division all="All Divisions",
type="Customer Base" * expenditures=" " * sum=" "
/ rts=25 box=_page_ condense indent=1;
format region regfmt. division divfmt. type usetype.;
title "Energy Expenditures for Each Region and All Regions";
title2 "(millions od dollars)";
run;

data _null_;
if 0 then set customer_response nobs=count;
call symput("num", left(put(count, 4.)));
stop;
run;

proc format;
picture pctfmt low-high="009.9 %";
run;

proc tabulate data=customer_response;
var factor1-factor4 customer;
table
factor1="Cost"
factor2="Performance"
factor3="Reliability"
factor4="Sales Staff",
(n="Count"*f=7. pctn<customer>="Percent"*f=pctfmt9.);
title "Customer Survey Results: Spring 1996";
title3 "Factors Influencing the Decision to Buy";
run;

proc tabulate data=customer_response;
var source1-source3 customer;
table source1="TV/Radio"
source2="Newspaper"
source3="Word of Mouth",
(n="Count"*f=7. pctn<customer>="Percent"*f=pctfmt9.);
title "Source of Company Name";
footnote "Number of Respondents: &num.";
run;

proc tabulate data=;

run;